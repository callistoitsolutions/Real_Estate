<form method="post" enctype="multipart/form-data" class="p-4 rounded bg-light needs-validation">
    {% csrf_token %}
    <div class="mb-3">
        <label class="form-label">Blog Title</label>
        <input type="text" name="title" maxlength="100" value="Residential Rental Properties in Nagpur" 
               class="form-control" id="title-input" required 
               oninput="countChars(this, 'title-count', 100)">
        <small id="title-count" class="text-muted">36 / 100</small>
    </div>

    <div class="mb-3">
        <label class="form-label">SEO Description</label>
        <textarea name="description" maxlength="160" class="form-control" id="desc-input" required 
                  oninput="countChars(this, 'desc-count', 160)">Discover affordable residential properties in Nagpur, including flats, apartments, and rental homes near IT hubs, schools, and prime locations.</textarea>
        <small id="desc-count" class="text-muted">150 / 160</small>
    </div>

    <div class="mb-3">
    <label class="form-label">Author Name</label>
    <input type="text" name="author" class="form-control" value="Admin" required>
</div>

    <div class="mb-3">
        <label class="form-label">Content</label>
        <textarea name="content" rows="8" class="form-control" id="content-input" required 
                  oninput="countChars(this, 'content-count', 2000)">Nagpur has become one of the fastest-growing urban centers in Maharashtra, attracting students, professionals, and families alike. For those seeking a comfortable lifestyle, residential properties in Nagpur offer a wide variety of options ranging from compact 1BHK flats to luxurious 3BHK apartments. 

Most people searching for flats for rent in Nagpur prefer areas like Pratap Nagar, Civil Lines, and Dharampeth, which are well-connected and close to workplaces, schools, and hospitals. With the metro improving accessibility, demand for 2BHK apartments in Nagpur has increased, especially among young professionals and nuclear families. 

Affordability is another reason why rental homes in Nagpur are gaining popularity. Compared to larger cities like Pune or Mumbai, rental rates are reasonable, making it possible for tenants to enjoy modern housing at competitive prices. Many gated communities also provide amenities like gyms, play areas, and round-the-clock security, ensuring a safe environment for families. 

The IT and industrial growth around MIHAN and Hingna Road has boosted housing demand, with professionals preferring residential flats near IT park Nagpur. This has created a healthy mix of budget and premium rental segments across the city. 

In conclusion, if you are looking for affordable housing in Nagpur, the city offers diverse residential choices to suit every lifestyle and budget. Whether you are a student, working professional, or family, Nagpurâ€™s rental market has something to match your needs.</textarea>
        <small id="content-count" class="text-muted">490 / 2000</small>
    </div>

    <div class="mb-3">
        <label class="form-label">Primary Keyword</label>
        <input type="text" name="primary_keyword" class="form-control" maxlength="30" 
               value="Residential properties in Nagpur"
               id="primary-keyword" required 
               oninput="countKeywordInstances('primary-keyword','content-input','primary-keyword-count')">
        <small id="primary-keyword-count" class="text-muted">Occurrences: 2</small>
    </div>

    <div class="mb-3">
        <label class="form-label">Secondary Keywords (comma-separated)</label>
        <input type="text" name="secondary_keywords" class="form-control" maxlength="150" 
               value="flats for rent in Nagpur, 2BHK apartments Nagpur, affordable housing Nagpur, rental homes near IT park Nagpur"
               id="secondary-keyword" 
               oninput="countSecondaryKeywords(this, 'secondary-keyword-count','content-input')">
        <small id="secondary-keyword-count" class="text-muted">Count: 4, Occurrences: 6</small>
    </div>

   <div class="mb-3">
  <label class="form-label">Categories</label>
  <select name="categories" class="form-select" multiple required>
    {% for cat in categories %}
      <option value="{{ cat.id }}">{{ cat.name }}</option>
    {% endfor %}
  </select>
</div>


    <div class="mb-3">
        <label class="form-label">Featured Image</label>
        <input type="file" name="featured_image" accept="image/*" class="form-control">
        <select name="img_position" class="form-select mt-2">
            <option value="center" selected>Center</option>
            <option value="left">Left Corner</option>
            <option value="right">Right Corner</option>
            <option value="inline">In Between Words</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Publish Blog</button>
</form>

<script>
// Character Counter
function countChars(el, counterId, max) {
    document.getElementById(counterId).innerText = `${el.value.length} / ${max}`;
}
// Primary Keyword Occurrence
function countKeywordInstances(keywordId, contentId, countId) {
    let keyword = document.getElementById(keywordId).value.trim();
    let content = document.getElementById(contentId).value;
    if (!keyword) return document.getElementById(countId).innerText = 'Occurrences: 0';
    let count = (content.match(new RegExp("\\b" + keyword + "\\b", "gi")) || []).length;
    document.getElementById(countId).innerText = `Occurrences: ${count}`;
}
// Secondary Keywords
function countSecondaryKeywords(input, counterId, contentId) {
    let keywords = input.value.split(',').map(s=>s.trim()).filter(Boolean);
    let content = document.getElementById(contentId).value;
    let occ = 0;
    keywords.forEach(kw=>{
        occ += (content.match(new RegExp("\\b" + kw + "\\b", "gi")) || []).length;
    });
    document.getElementById(counterId).innerText = `Count: ${keywords.length}, Occurrences: ${occ}`;
}
</script>
